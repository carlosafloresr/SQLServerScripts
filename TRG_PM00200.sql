CREATE TRIGGER TRG_PM00200 ON dbo.PM00200
FOR INSERT, UPDATE, DELETE
AS
BEGIN
	DECLARE @UserId		Varchar(50),
			@Company	Varchar(5) = DB_NAME() -- Identifies the current database

	SET @UserId = (SELECT TOP 1 loginame FROM Master..sysprocesses WHERE SID = SUSER_SID()) -- Pulls the connected user id

	IF EXISTS(SELECT * FROM Deleted) -- On deletes and updates
	BEGIN
		INSERT INTO GPCustom.dbo.GP_PM00200_Logs
				([COMPANY]
				,[VENDORID]
				,[VENDNAME]
				,[VNDCHKNM]
				,[VENDSHNM]
				,[VADDCDPR]
				,[VADCDPAD]
				,[VADCDSFR]
				,[VADCDTRO]
				,[VNDCLSID]
				,[VNDCNTCT]
				,[ADDRESS1]
				,[ADDRESS2]
				,[ADDRESS3]
				,[CITY]
				,[STATE]
				,[ZIPCODE]
				,[COUNTRY]
				,[PHNUMBR1]
				,[PHNUMBR2]
				,[PHONE3]
				,[FAXNUMBR]
				,[UPSZONE]
				,[SHIPMTHD]
				,[TAXSCHID]
				,[ACNMVNDR]
				,[TXIDNMBR]
				,[VENDSTTS]
				,[CURNCYID]
				,[TXRGNNUM]
				,[PARVENID]
				,[TRDDISCT]
				,[TEN99TYPE]
				,[TEN99BOXNUMBER]
				,[MINORDER]
				,[PYMTRMID]
				,[MINPYTYP]
				,[MINPYPCT]
				,[MINPYDLR]
				,[MXIAFVND]
				,[MAXINDLR]
				,[COMMENT1]
				,[COMMENT2]
				,[USERDEF1]
				,[USERDEF2]
				,[CRLMTDLR]
				,[PYMNTPRI]
				,[KPCALHST]
				,[KGLDSTHS]
				,[KPERHIST]
				,[KPTRXHST]
				,[HOLD]
				,[PTCSHACF]
				,[CREDTLMT]
				,[WRITEOFF]
				,[MXWOFAMT]
				,[SBPPSDED]
				,[PPSTAXRT]
				,[DXVARNUM]
				,[CRTCOMDT]
				,[CRTEXPDT]
				,[RTOBUTKN]
				,[XPDTOBLG]
				,[PRSPAYEE]
				,[PMAPINDX]
				,[PMCSHIDX]
				,[PMDAVIDX]
				,[PMDTKIDX]
				,[PMFINIDX]
				,[PMMSCHIX]
				,[PMFRTIDX]
				,[PMTAXIDX]
				,[PMWRTIDX]
				,[PMPRCHIX]
				,[PMRTNGIX]
				,[PMTDSCIX]
				,[ACPURIDX]
				,[PURPVIDX]
				,[NOTEINDX]
				,[CHEKBKID]
				,[MODIFDT]
				,[CREATDDT]
				,[RATETPID]
				,[Revalue_Vendor]
				,[Post_Results_To]
				,[FREEONBOARD]
				,[GOVCRPID]
				,[GOVINDID]
				,[DISGRPER]
				,[DUEGRPER]
				,[DOCFMTID]
				,[TaxInvRecvd]
				,[USERLANG]
				,[WithholdingType]
				,[WithholdingFormType]
				,[WithholdingEntityType]
				,[TaxFileNumMode]
				,[BRTHDATE]
				,[LaborPmtType]
				,[CCode]
				,[DECLID]
				,[CBVAT]
				,[Workflow_Approval_Status]
				,[Workflow_Priority]
				,[Workflow_Status]
				,[VADCD1099]
				,[ONEPAYPERVENDINV]
				,[VENDDBA]
				,[DEX_ROW_TS]
				,[DEX_ROW_ID]
				,[CHANGEDON]
				,[CHANGED BY])
		SELECT	@Company
				,[VENDORID]
				,[VENDNAME]
				,[VNDCHKNM]
				,[VENDSHNM]
				,[VADDCDPR]
				,[VADCDPAD]
				,[VADCDSFR]
				,[VADCDTRO]
				,[VNDCLSID]
				,[VNDCNTCT]
				,[ADDRESS1]
				,[ADDRESS2]
				,[ADDRESS3]
				,[CITY]
				,[STATE]
				,[ZIPCODE]
				,[COUNTRY]
				,[PHNUMBR1]
				,[PHNUMBR2]
				,[PHONE3]
				,[FAXNUMBR]
				,[UPSZONE]
				,[SHIPMTHD]
				,[TAXSCHID]
				,[ACNMVNDR]
				,[TXIDNMBR]
				,[VENDSTTS]
				,[CURNCYID]
				,[TXRGNNUM]
				,[PARVENID]
				,[TRDDISCT]
				,[TEN99TYPE]
				,[TEN99BOXNUMBER]
				,[MINORDER]
				,[PYMTRMID]
				,[MINPYTYP]
				,[MINPYPCT]
				,[MINPYDLR]
				,[MXIAFVND]
				,[MAXINDLR]
				,[COMMENT1]
				,[COMMENT2]
				,[USERDEF1]
				,[USERDEF2]
				,[CRLMTDLR]
				,[PYMNTPRI]
				,[KPCALHST]
				,[KGLDSTHS]
				,[KPERHIST]
				,[KPTRXHST]
				,[HOLD]
				,[PTCSHACF]
				,[CREDTLMT]
				,[WRITEOFF]
				,[MXWOFAMT]
				,[SBPPSDED]
				,[PPSTAXRT]
				,[DXVARNUM]
				,[CRTCOMDT]
				,[CRTEXPDT]
				,[RTOBUTKN]
				,[XPDTOBLG]
				,[PRSPAYEE]
				,[PMAPINDX]
				,[PMCSHIDX]
				,[PMDAVIDX]
				,[PMDTKIDX]
				,[PMFINIDX]
				,[PMMSCHIX]
				,[PMFRTIDX]
				,[PMTAXIDX]
				,[PMWRTIDX]
				,[PMPRCHIX]
				,[PMRTNGIX]
				,[PMTDSCIX]
				,[ACPURIDX]
				,[PURPVIDX]
				,[NOTEINDX]
				,[CHEKBKID]
				,[MODIFDT]
				,[CREATDDT]
				,[RATETPID]
				,[Revalue_Vendor]
				,[Post_Results_To]
				,[FREEONBOARD]
				,[GOVCRPID]
				,[GOVINDID]
				,[DISGRPER]
				,[DUEGRPER]
				,[DOCFMTID]
				,[TaxInvRecvd]
				,[USERLANG]
				,[WithholdingType]
				,[WithholdingFormType]
				,[WithholdingEntityType]
				,[TaxFileNumMode]
				,[BRTHDATE]
				,[LaborPmtType]
				,[CCode]
				,[DECLID]
				,[CBVAT]
				,[Workflow_Approval_Status]
				,[Workflow_Priority]
				,[Workflow_Status]
				,[VADCD1099]
				,[ONEPAYPERVENDINV]
				,[VENDDBA]
				,[DEX_ROW_TS]
				,[DEX_ROW_ID]
				,GETDATE() AS [CHANGEDON]
				,@UserId AS [CHANGEDBY]
		FROM	DELETED
	END
	ELSE
	BEGIN
		INSERT INTO GPCustom.dbo.GP_PM00200_Logs -- For inserts
				([COMPANY]
				,[VENDORID]
				,[VENDNAME]
				,[VNDCHKNM]
				,[VENDSHNM]
				,[VADDCDPR]
				,[VADCDPAD]
				,[VADCDSFR]
				,[VADCDTRO]
				,[VNDCLSID]
				,[VNDCNTCT]
				,[ADDRESS1]
				,[ADDRESS2]
				,[ADDRESS3]
				,[CITY]
				,[STATE]
				,[ZIPCODE]
				,[COUNTRY]
				,[PHNUMBR1]
				,[PHNUMBR2]
				,[PHONE3]
				,[FAXNUMBR]
				,[UPSZONE]
				,[SHIPMTHD]
				,[TAXSCHID]
				,[ACNMVNDR]
				,[TXIDNMBR]
				,[VENDSTTS]
				,[CURNCYID]
				,[TXRGNNUM]
				,[PARVENID]
				,[TRDDISCT]
				,[TEN99TYPE]
				,[TEN99BOXNUMBER]
				,[MINORDER]
				,[PYMTRMID]
				,[MINPYTYP]
				,[MINPYPCT]
				,[MINPYDLR]
				,[MXIAFVND]
				,[MAXINDLR]
				,[COMMENT1]
				,[COMMENT2]
				,[USERDEF1]
				,[USERDEF2]
				,[CRLMTDLR]
				,[PYMNTPRI]
				,[KPCALHST]
				,[KGLDSTHS]
				,[KPERHIST]
				,[KPTRXHST]
				,[HOLD]
				,[PTCSHACF]
				,[CREDTLMT]
				,[WRITEOFF]
				,[MXWOFAMT]
				,[SBPPSDED]
				,[PPSTAXRT]
				,[DXVARNUM]
				,[CRTCOMDT]
				,[CRTEXPDT]
				,[RTOBUTKN]
				,[XPDTOBLG]
				,[PRSPAYEE]
				,[PMAPINDX]
				,[PMCSHIDX]
				,[PMDAVIDX]
				,[PMDTKIDX]
				,[PMFINIDX]
				,[PMMSCHIX]
				,[PMFRTIDX]
				,[PMTAXIDX]
				,[PMWRTIDX]
				,[PMPRCHIX]
				,[PMRTNGIX]
				,[PMTDSCIX]
				,[ACPURIDX]
				,[PURPVIDX]
				,[NOTEINDX]
				,[CHEKBKID]
				,[MODIFDT]
				,[CREATDDT]
				,[RATETPID]
				,[Revalue_Vendor]
				,[Post_Results_To]
				,[FREEONBOARD]
				,[GOVCRPID]
				,[GOVINDID]
				,[DISGRPER]
				,[DUEGRPER]
				,[DOCFMTID]
				,[TaxInvRecvd]
				,[USERLANG]
				,[WithholdingType]
				,[WithholdingFormType]
				,[WithholdingEntityType]
				,[TaxFileNumMode]
				,[BRTHDATE]
				,[LaborPmtType]
				,[CCode]
				,[DECLID]
				,[CBVAT]
				,[Workflow_Approval_Status]
				,[Workflow_Priority]
				,[Workflow_Status]
				,[VADCD1099]
				,[ONEPAYPERVENDINV]
				,[VENDDBA]
				,[DEX_ROW_TS]
				,[DEX_ROW_ID]
				,[CHANGEDON]
				,[CHANGED BY])
		SELECT	@Company
				,[VENDORID]
				,[VENDNAME]
				,[VNDCHKNM]
				,[VENDSHNM]
				,[VADDCDPR]
				,[VADCDPAD]
				,[VADCDSFR]
				,[VADCDTRO]
				,[VNDCLSID]
				,[VNDCNTCT]
				,[ADDRESS1]
				,[ADDRESS2]
				,[ADDRESS3]
				,[CITY]
				,[STATE]
				,[ZIPCODE]
				,[COUNTRY]
				,[PHNUMBR1]
				,[PHNUMBR2]
				,[PHONE3]
				,[FAXNUMBR]
				,[UPSZONE]
				,[SHIPMTHD]
				,[TAXSCHID]
				,[ACNMVNDR]
				,[TXIDNMBR]
				,[VENDSTTS]
				,[CURNCYID]
				,[TXRGNNUM]
				,[PARVENID]
				,[TRDDISCT]
				,[TEN99TYPE]
				,[TEN99BOXNUMBER]
				,[MINORDER]
				,[PYMTRMID]
				,[MINPYTYP]
				,[MINPYPCT]
				,[MINPYDLR]
				,[MXIAFVND]
				,[MAXINDLR]
				,[COMMENT1]
				,[COMMENT2]
				,[USERDEF1]
				,[USERDEF2]
				,[CRLMTDLR]
				,[PYMNTPRI]
				,[KPCALHST]
				,[KGLDSTHS]
				,[KPERHIST]
				,[KPTRXHST]
				,[HOLD]
				,[PTCSHACF]
				,[CREDTLMT]
				,[WRITEOFF]
				,[MXWOFAMT]
				,[SBPPSDED]
				,[PPSTAXRT]
				,[DXVARNUM]
				,[CRTCOMDT]
				,[CRTEXPDT]
				,[RTOBUTKN]
				,[XPDTOBLG]
				,[PRSPAYEE]
				,[PMAPINDX]
				,[PMCSHIDX]
				,[PMDAVIDX]
				,[PMDTKIDX]
				,[PMFINIDX]
				,[PMMSCHIX]
				,[PMFRTIDX]
				,[PMTAXIDX]
				,[PMWRTIDX]
				,[PMPRCHIX]
				,[PMRTNGIX]
				,[PMTDSCIX]
				,[ACPURIDX]
				,[PURPVIDX]
				,[NOTEINDX]
				,[CHEKBKID]
				,[MODIFDT]
				,[CREATDDT]
				,[RATETPID]
				,[Revalue_Vendor]
				,[Post_Results_To]
				,[FREEONBOARD]
				,[GOVCRPID]
				,[GOVINDID]
				,[DISGRPER]
				,[DUEGRPER]
				,[DOCFMTID]
				,[TaxInvRecvd]
				,[USERLANG]
				,[WithholdingType]
				,[WithholdingFormType]
				,[WithholdingEntityType]
				,[TaxFileNumMode]
				,[BRTHDATE]
				,[LaborPmtType]
				,[CCode]
				,[DECLID]
				,[CBVAT]
				,[Workflow_Approval_Status]
				,[Workflow_Priority]
				,[Workflow_Status]
				,[VADCD1099]
				,[ONEPAYPERVENDINV]
				,[VENDDBA]
				,[DEX_ROW_TS]
				,[DEX_ROW_ID]
				,GETDATE() AS [CHANGEDON]
				,@UserId AS [CHANGEDBY]
		FROM	Inserted
	END
END