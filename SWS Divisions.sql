EXECUTE USP_QuerySWS N'SELECT DISTINCT DIV.Code, DIV.Name, CASE WHEN COM.AgentOf_Cmpy_No > 0 THEN COM.AgentOf_Cmpy_No ELSE DIV.Cmpy_No END AS Cmpy_No, DIV.Status, DIV.rgn_code, REG.Name AS rgn_name, COM.Name AS AgentName FROM TRK.Division DIV INNER JOIN com.company COM ON DIV.Cmpy_No = COM.No LEFT JOIN Trk.Region REG ON DIV.rgn_code = REG.Code WHERE DIV.Code <> ''99'' ORDER BY 3, 1'