UPDATE	OOS_Deductions
SET		OOS_Deductions.MaxDeduction = 1000
FROM	(
SELECT	DED.OOS_DeductionId,
		DED.Vendorid,
		DED.MaxDeduction,
		DED.DeductionAmount,
		TYP.DeductionCode,
		VND.HireDate,
		VND.Agent,
		VND.SubType
FROM	OOS_Deductions DED
		INNER JOIN OOS_DeductionTypes TYP ON DED.FK_OOS_DeductionTypeId = TYP.OOS_DeductionTypeId
		INNER JOIN VendorMaster VND ON DED.VENDORID = VND.VENDORID AND TYP.Company = VND.Company AND VND.TerminationDate IS Null
WHERE	DED.MaxDeduction > 0
		AND TYP.DeductionCode = 'CESC'
		AND DED.VENDORID IN ('N10007',
'N10008',
'N10071',
'N10083',
'N10360',
'N10368',
'N10369',
'N10370',
'N10371',
'N12030',
'N12055',
'N12056',
'N12067',
'N12071',
'N12117',
'N12127',
'N12129',
'N22005',
'N22021',
'N22024',
'N22058',
'N22065',
'N22066',
'N22067',
'N22207',
'N22208',
'N22209',
'N22401',
'N22437',
'N22672',
'N31030',
'N31036',
'N31053',
'N31061',
'N31064',
'N31065',
'N46004',
'N46007',
'N46008',
'N46009',
'N46010',
'N46011',
'N46015',
'N46018',
'N46020',
'N46022',
'N46023',
'N46026',
'N46027',
'N46032',
'N46033',
'N46034',
'N46035',
'N46039',
'N46040',
'N46043',
'N46045',
'N46047',
'N46048',
'N46049',
'N46052',
'N46059',
'N46060',
'N46062',
'N46064',
'N46068',
'N46072',
'N46073',
'N46074',
'N46075',
'N46077',
'N46079',
'N46086',
'N46087',
'N46089')
) DATA
WHERE	OOS_Deductions.OOS_DeductionId = DATA.OOS_DeductionId
		AND ((DATA.Agent IN ('10','12') AND DATA.SubType = 1)
		OR (DATA.Agent IN ('31','46') AND DATA.SubType > 0)
		OR (DATA.Agent = '22' AND DATA.SubType = 1 AND YEAR(DATA.HireDate) = 2011))