--select * from RM30301
--select * from RM10101

SELECT 	OpenYear,
	JrnEntry AS Journal,
	ORGNTSRC,
	Refrence,
	TrxDate AS TransactionDate,
	UswhPstd AS PostingUser,
	OrmstrId AS CustomerId,
	Ormstrnm AS CustomerName,
	Orpstddt AS PostingDate,
	GL20000.ACTINDX,
	RTRIM(ACTNUMBR_1) + '-' + RTRIM(ACTNUMBR_2) + '-' + RTRIM(ACTNUMBR_3) AS Account,
	ActDescr,
	ORCTRNUM AS DocNumber,
	OrigSeqNum,
	GL20000.CrdtAmnt,
	GL20000.DebitAmt
FROM	GL20000
	LEFT JOIN GL00100 ON GL20000.ACTINDX = GL00100.ACTINDX
	LEFT JOIN RM30301 ON GL20000.ORCTRNUM = RM30301.DocNumbr AND GL20000.ORGNTSRC = RM30301.TRXSORCE AND GL20000.ACTINDX = RM30301.DSTINDX AND GL20000.ORIGSEQNUM = RM30301.SEQNUMBR
	LEFT JOIN RM10101 ON GL20000.ORCTRNUM = RM10101.DocNumbr AND GL20000.ORGNTSRC = RM10101.TRXSORCE AND GL20000.ACTINDX = RM10101.DSTINDX AND GL20000.ORIGSEQNUM = RM10101.SEQNUMBR
WHERE	LEFT(ORGNTSRC, 5) = 'RMCSH' AND 
	ISNULL(RM30301.DocNumbr, RM10101.DocNumbr) IS NULL
ORDER BY
	RTRIM(ACTNUMBR_1) + '-' + RTRIM(ACTNUMBR_2) + '-' + RTRIM(ACTNUMBR_3)