SET NOCOUNT ON

DECLARE @tblGPData Table (Voucher Varchar(25), DocNumber Varchar(35))

INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658869107820','1010536')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658865992250','1013354')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658869517230','1013811')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658873915311','1013976')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658866777586','1014724')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950425695','1015945')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658869572068','1016068')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658866745391','1016195')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658873904588','1016246')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658873804252','1016248')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658865468687','1016549')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950549780','1016957')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950555371','1016964')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950597778','1016965')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950560536','1016966')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950592180','1017215')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950566093','1017219')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658869637722','1017253')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658863695392','1017253A')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950458883','1017255')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950571223','1017284')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950576562','1017295')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950581601','1017298')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950431191','1017351')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950529829','1017835')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950524499','1017844')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950537273','1017846')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950772564','1017854')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950518494','1017858')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950464344','1017908')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950544092','1017957')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950586794','1017960')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950439616','1017961')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950446508','1017964')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658946213601','1010475')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658943894084','1010483')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658938832072','1010519')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658936571549','1010531')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658944417164','1010546')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658949081117','1010551')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658943526393','1010555')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658944663084','1010588')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658950220419','1012510')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658943592377','1012510A')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658938587344','1013072')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658952896220','1013346')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658955533191','1014400')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658956265829','1014417')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954074838','1014427')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658958466358','1014431')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954280389','1014435')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658955735362','1014438')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954596746','1014440')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658957050070','1014451')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658957479888','1014456')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954508366','1014458')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955284749','1014461')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954510280','1014463')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658956978987','1014464')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658956977471','1014467')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658956980518','1014468')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658957639783','1014470')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658957642329','1014474')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658942533964','1014715')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658954547779','1014734')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951026595','1015013')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658947830855','1015202')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1658955636456','1015743')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951049084','1015902')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955731085','1016171')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658956108107','1016174')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658949901598','1016278')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658948002931','1016292')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954775129','1016294')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658937786315','1016424')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658937795343','1016425')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954655682','1016465')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658936577818','1016472')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658938778464','1016494')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658939093328','1016510')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658943478554','1016544')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658942955936','1016545')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658942963113','1016546')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658946056510','1016548')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658947151011','1016550')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951088496','1016852')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950794435','1017069')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951083206','1017191')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658962040452','1017213')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951036260','1017349')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951020487','1017829')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955028760','1017832')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951058875','1017833')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951065063','1017842')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951054261','1017901')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951070346','1017902')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951076530','1017903')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658962057486','1017917')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950986912','1017959')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658945228920','1018218')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955013731','1018499')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951015194','1018627')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955034565','1018631')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658950455104','1018632')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658962053018','1018688')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658962070405','1018693')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658962047445','1018703')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951043153','1018721')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955021983','1018730')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658951094022','1018732')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658955039996','1018966')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658944818464','95-264740')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658938669875','95-276555')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1658954660178','95-279935')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659043288419','1010477')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659017095749','1013817')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659020742329','1013845')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659019643690','1014401')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016408891','1014405')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659044226794','1014413')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659021728175','1014416')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016938624','1014425')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659023597475','1014426')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659025002378','1014429')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659023951829','1014432')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659023601900','1014442')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016012817','1014444')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016008588','1014447')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016021460','1014448')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016016945','1014449')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659023961088','1014459')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659017922815','1014460')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659044230902','1014733')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659044220537','1014735')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659019966234','1014749')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659020277473','1014852')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659018124886','1015630')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659039337105','1016110')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659041115762','1016111')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659036877809','1016115')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659039341170','1016204')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659039345436','1016205')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659038285665','1016213')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659023185945','1016293')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659044960074','1017831')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659044733087','1017865')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659026917671','1018517')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659043393947','1018697')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659036553784','1018712')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659043419831','1018994')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659026843684','1019092')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659045344508','1019094')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659043354044','1019155')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659016403990','288745')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659021817334','95-272826')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659131971623','1010479')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659125438688','1013794')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659125374088','1013805')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659110446142','1014406')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659107364402','1014414')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659112632818','1014719')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131649923','1015533')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659125117293','1015550')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659130004658','1015941')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659110450525','1016102')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659102143783','1016109')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659122203531','1016146')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659110909517','1016160')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659110913611','1016164')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659106664918','1016187')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659121410386','1016247')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659124654312','1016249')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659126103035','1017850')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659128430679','1017859')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124981650','1017867')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659125010456','1017872')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124998480','1017899')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659126075843','1017904')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659126300686','1018405')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131520281','1018405A')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659111866979','1018500')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659128345410','1018505')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131713141','1018505A')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131750035','1018515')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131700526','1018518')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659110687056','1018519')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131739486','1018522')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131690036','1018561')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124810232','1018562')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131663191','1018565')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124391681','1018625')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124968870','1018689')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659102518815','1018692')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124840302','1018698')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659121777485','1018699')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659121744404','1018700')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124778353','1018702')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124739187','1018711')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131674338','1018713')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659119841393','1018729')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131729583','1018731')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131781897','1018737')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124642770','1018749')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124716504','1018751')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659119807499','1018755')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124377401','1018757')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659110720889','1018812')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124654532','1018897')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124762276','1018927')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659121715267','1018979')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659112268925','1018980')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659126089086','1018995')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124357998','1018998')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659121727189','1019093')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124853872','1019098')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124890169','1019138')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659111631356','1019150')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659129989236','1019151')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124954581','1019153')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131759964','1019156')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659127983981','1019157')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131794017','1019159')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659131771226','1019433')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659126116104','1019434')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659121760437','1019438')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124918839','1019492')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124609443','1019494')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659124622117','1019533')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659356828462','1018559')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659356817341','1018724')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659198454811','1011907A')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659198248313','1011909A')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383325283','1010500')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383236157','1010502')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659383443941','1010513')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383450435','1010518')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659385095491','1010545')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659386468083','1010548')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659382935211','1010554')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659383032552','1010563')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383713787','1010583')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383706339','1010592')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383515633','1010594')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659372129539','1011902')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659372162022','1011906')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659359385328','1013836')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659382901481','1014850')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659382776835','1014851')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659382895033','1014853')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659384024209','1015217')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659382235465','1015632')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659382389777','1015633')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('ACR1659383954779','1016371')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659382221784','1017580')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659384981431','95-261723')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659384173261','95-264716')
INSERT INTO @tblGPData (Voucher, DocNumber) VALUES ('PP1659383799573','95-264724')

BEGIN TRANSACTION

UPDATE	PM20000
SET		PM20000.PYMTRMID = DATA.NewPayTermId,
		PM20000.DUEDATE  = IIF(CAST(DATA.DUEDATE AS Date) = CAST(GETDATE() AS Date), DATEADD(dd, 1, DATA.DUEDATE), DATA.DUEDATE),
		PM20000.DISCAMNT = DATA.DISCOUNT 
FROM	(
		SELECT	DTA.*,
				PMH.DOCNUMBR,
				PMH.DOCAMNT,
				PMH.DOCDATE,
				PMH.PYMTRMID,
				PMH.DEX_ROW_ID AS RECORDID,
				DATEADD(DD, 7, PMH.DOCDATE) AS DUEDATE,
				'3% 7 Days Net 30' AS NewPayTermId,
				ROUND(PMH.DOCAMNT * .03, 2) AS DISCOUNT
		FROM	@tblGPData DTA
				LEFT JOIN PM20000 PMH ON DTA.VOUCHER = PMH.VCHRNMBR AND DTA.DocNumber = PMH.DOCNUMBR
		) DATA
WHERE	PM20000.DEX_ROW_ID = DATA.RECORDID

IF @@ERROR = 0
	COMMIT TRANSACTION
ELSE
	ROLLBACK TRANSACTION

SELECT	PMH.*
FROM	@tblGPData DTA
		LEFT JOIN PM20000 PMH ON DTA.VOUCHER = PMH.VCHRNMBR AND DTA.DocNumber = PMH.DOCNUMBR