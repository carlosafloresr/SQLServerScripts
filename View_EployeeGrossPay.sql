SELECT	UPR00100.DEPRTMNT,
		UPR40300.DSCRIPTN AS Department,
		UPR00100.EMPLOYID,
		RTRIM(UPR00100.LASTNAME) + ', ' + RTRIM(UPR00100.FRSTNAME) + ISNULL(' ' + UPR00100.MIDLNAME,'') AS FullName,
		UPR40300.DSCRIPTN AS Position,
		UPR00100.STRTDATE AS HireDate,
		UPR30300.CHEKDATE,
		SUM(CASE WHEN UPR30300.PYRLRTYP IN (2, 4) THEN -1 ELSE 1 END * UPR30300.UPRTRXAM) AS GrossAmount
FROM	UPR30300 
		INNER JOIN UPR00100 ON UPR30300.EMPLOYID = UPR00100.EMPLOYID
		INNER JOIN UPR40300 ON UPR00100.DEPRTMNT = UPR40300.DEPRTMNT
		INNER JOIN UPR40301 ON UPR00100.JOBTITLE = UPR40301.JOBTITLE
WHERE	UPR30300.CHEKDATE BETWEEN '2010-03-01' AND '2010-03-19' 
		AND UPR30300.PYRLRTYP = 1
GROUP BY
		UPR00100.DEPRTMNT,
		UPR40300.DSCRIPTN,
		UPR00100.EMPLOYID,
		UPR00100.LASTNAME,
		UPR00100.FRSTNAME,
		UPR00100.MIDLNAME,
		UPR40300.DSCRIPTN,
		UPR00100.STRTDATE,
		UPR30300.CHEKDATE

-- SELECT * FROM UPR30300 WHERE EMPLOYID = '41' AND CHEKDATE = '03/04/2010' AND PYRLRTYP <> 3

/*
SELECT	UPR30300.PAYROLCD, 
		UPR30300.UPRTRXAM, 
		UPR30300.CHEKDATE, 
		UPR00100.LASTNAME, 
		UPR00100.FRSTNAME, 
		UPR00100.MIDLNAME, 
		UPR00100.DEPRTMNT, 
		UPR30300.EMPLOYID, 
		UPR30300.CHEKNMBR, 
		UPR30300.PYRLRTYP, 
		UPR00100.STRTDATE, 
		UPR40301.DSCRIPTN, 
		UPR40300.DSCRIPTN
FROM	UPR30300 
		INNER JOIN UPR00100 ON UPR30300.EMPLOYID = UPR00100.EMPLOYID
		INNER JOIN UPR40300 ON UPR00100.DEPRTMNT = UPR40300.DEPRTMNT
		INNER JOIN UPR40301 ON UPR00100.JOBTITLE = UPR40301.JOBTITLE
WHERE	UPR30300.CHEKDATE BETWEEN '2010-03-01' AND '2010-03-19' 
		AND UPR30300.PYRLRTYP <> 3

*/