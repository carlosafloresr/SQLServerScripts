DECLARE	@RunDate Date = '08/01/2013'

SELECT	COUNT(EmployId) AS HeadCount
FROM	UPR00100
WHERE	DEPRTMNT = '529'
		AND (DEMPINAC < '01/01/1980' OR DEMPINAC > @RunDate)

SELECT	SUM(GRWGPRN) AS Salaries
FROM	UPR30100
WHERE	EMPLOYID IN (SELECT EMPLOYID FROM UPR00100 WHERE DEPRTMNT = '529' AND (DEMPINAC < '01/01/1980' OR DEMPINAC > @RunDate))
		AND CHEKDATE = GPCustom.dbo.DayFwdBack(@RunDate, 'P', 'Thursday')