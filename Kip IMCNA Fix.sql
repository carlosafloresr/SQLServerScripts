SET NOCOUNT ON

DECLARE	@Invoice	Varchar(12), 
		@Amount		Numeric(10,2)

DECLARE @tblData	Table (Invoice Varchar(12), Amount Numeric(10,2))

INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133878',-2512.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134795',-2390)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135359',-2351.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133877',-2291.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133882',-1861.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134447',-1371.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136112',-1296.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133883',-1286.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137424',-1221.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137422',-1176.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134156',-1156.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136849',-1107.45)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133872',-1065)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137519',-1056.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136907',-1035.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134284',-986.96)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136131',-986.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134066',-816.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134416',-816.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137506',-801.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133908',-795)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137561',-791.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136754',-777.01)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136139',-766.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137539',-766.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133871',-755)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137426',-741.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137538',-741.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137564',-741.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137509',-716.95)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133852',-691.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125708',-680)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134243',-666.95)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137536',-651.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137423',-626.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134106',-606.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133865',-600)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-126785',-500)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136137',-491.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137528',-491.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137550',-491.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136765',-490)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134349',-476.95)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134102',-466.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134108',-466.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137444',-466.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137487',-466.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137552',-466.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134098',-466.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137429',-431.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137572',-416.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-178547',-415)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-126507',-391.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-126508',-391.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135121',-391.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135504',-391.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137544',-391.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137559',-391.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-124662',-389.24)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-124664',-389.24)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-124665',-389.24)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134104',-381.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136924',-366.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136797',-325.01)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184237',-290)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184644',-290)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137545',-286.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134452',-231.95)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-124204',-125)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127845',-66.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136128',-66.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137396',-66.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137474',-66.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137553',-66.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135507',-66.94)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134928',32.25)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-170695',241.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183844',241.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188001',241.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188176',241.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188502',241.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-173580',330)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-173440',330.5)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138733',332.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-175792',343.35)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-169442',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-170434',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-170702',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-171136',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174209',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174548',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174559',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174566',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174953',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174955',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-175838',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-175920',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-178429',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-180039',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-182542',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183701',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183730',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183737',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183746',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183757',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183801',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184197',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184731',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184745',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185603',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185604',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185636',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185880',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186555',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186951',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186954',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186955',346.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-176030',360)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-177816',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186380',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-175041',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184343',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184730',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184974',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186478',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186554',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186824',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187634',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187635',366.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138597',372.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-142295',416)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138911',422.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136474',433.7)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136386',433.88)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138603',437.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188164',449)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187477',450)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187478',450)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187479',450)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183753',451.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-172645',451.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-177827',451.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183803',451.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183809',451.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185644',451.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136436',452.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138600',467.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-167752',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-172994',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-173430',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-174290',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-175982',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-180584',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-180930',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183744',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-183756',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184414',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184725',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184927',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185283',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185437',471.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184594',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184341',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184593',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184977',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184979',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185200',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185265',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185449',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185450',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185887',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185992',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185995',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186003',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186418',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186423',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186491',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186671',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186673',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187306',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187921',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187923',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188070',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188208',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188212',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188219',491.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138594',493.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133934',498.44)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140741',542.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-128556',587.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125517',587.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-130306',587.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-130310',587.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-139136',592)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-139138',592)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140765',601)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-142152',602.03)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140714',606)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184980',616.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185459',616.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185885',616.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186424',616.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187302',616.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188222',616.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138595',652.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138171',653.88)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186897',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186898',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186993',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187825',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188187',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188260',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188265',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188652',656)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-171264',656.25)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129817',660)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140743',662.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138578',670.63)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138625',673.88)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140716',686)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138583',700.63)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140740',702.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138584',735)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-180318',750)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186046',756)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140693',783.88)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-126804',785.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140447',792)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138622',792.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-122235',800)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-122236',800)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-122237',800)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-122238',800)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-122239',800)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140722',812.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140681',835.9)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185133',850)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-142108',857.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135844',870)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140721',900.63)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140843',913.7)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140699',914.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136382',919.2)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140777',930.9)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-184410',967)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-179809',974.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-180339',974.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-187342',974.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188094',974.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188135',974.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140715',976)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140742',977.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136483',978.65)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140844',1043.88)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-176220',1054.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-173212',1055)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-173213',1055)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138190',1056)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-170822',1060)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136422',1064.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-175713',1074.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185260',1074.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-186720',1074.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-188133',1074.68)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-185411',1100.28)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125070',1115)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135833',1124.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127701',1158.3)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140671',1159.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140724',1164.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140666',1182.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-132145',1197.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138192',1204.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137150',1207.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129810',1229.2)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-170091',1235)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-172685',1241.08)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135841',1243.88)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136421',1254.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140723',1269.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134626',1277.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140683',1284.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129907',1292.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129963',1307.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140700',1324.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-130361',1337)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138824',1368)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138213',1386)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138172',1401)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127712',1412.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138153',1426)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-133913',1437.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125345',1460.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127512',1488.3)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140701',1549.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129948',1582.03)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-140727',1666.08)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-169961',1670)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129424',1721)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127698',1735.8)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-142810',1750.62)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-176877',1776.1)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136373',1789.2)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125452',1869.9)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129962',1912.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134630',1954.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138163',1954.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127702',2038.3)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-130377',2056)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-126904',2124.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125652',2143.9)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-127692',2143.9)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129860',2179.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138598',2207)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134763',2222.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-173913',2246.5)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-171289',2296.5)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-138227',2352.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129856',2427.03)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134643',2494.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-136358',2532)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-125456',2533.3)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-126722',2579.5)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134637',2674.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129956',2697.03)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129958',2784.05)
INSERT INTO @tblData (Invoice, Amount) VALUES ('95-170098',3071.5)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-132728',3352)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-134738',3477.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129619',3761)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-137155',3832.4)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129036',4051)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-135803',4202)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-132134',4403.6)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129100',5214)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-128014',5653.9)
INSERT INTO @tblData (Invoice, Amount) VALUES ('96-129006',5878.4)

DECLARE	@tblResult Table (Invoice Varchar(12), Amount Numeric(10,2), InvoicNum Varchar(12), ChargeAmount1 Numeric(10,2), Reference Varchar(30), Document Varchar(30), RecordId Varchar(12))
DECLARE	@tblFinal  Table (Invoice Varchar(12), Amount Numeric(10,2), InvoicNum Varchar(12), ChargeAmount1 Numeric(10,2), Reference Varchar(30), Document Varchar(30), RecordId Varchar(12), Summary Numeric(10,2), Matched Smallint)

DECLARE curData CURSOR LOCAL KEYSET OPTIMISTIC FOR
SELECT	*
FROM	@tblData

OPEN curData 
FETCH FROM curData INTO @Invoice, @Amount

WHILE @@FETCH_STATUS = 0 
BEGIN
	INSERT INTO @tblResult
	SELECT	@Invoice,
			@Amount,
			FSI.InvoiceNumber,
			FSI.ChargeAmount1,
			FSI.PrepayReference,
			FSI.VendorDocument,
			CAST(FSI.FSI_ReceivedSubDetailId AS Varchar) + ','
	FROM	View_Integration_FSI_Full FSI
	WHERE	FSI.Company = 'GLSO' 
			AND FSI.InvoiceNumber = @Invoice 
			AND FSI.RecordType = 'VND'

	FETCH FROM curData INTO @Invoice, @Amount
END

CLOSE curData
DEALLOCATE curData

INSERT INTO @tblFinal
SELECT	*,
		CASE WHEN Amount = ChargeAmount1 THEN 1
			 WHEN Amount = Summary THEN 2
		ELSE 0 END AS Matched
FROM	(
		SELECT	DAT.*,
				Summary = (SELECT SUM(ChargeAmount1) FROM @tblResult TMP WHERE TMP.Invoice = DAT.Invoice)
		FROM	@tblResult DAT
		) DATA

SELECT	*
FROM	@tblFinal
WHERE	Matched > 0
		AND Amount > 0
		--AND Invoice = '95-167752'
ORDER BY Matched, Invoice