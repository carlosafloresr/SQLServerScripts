DECLARE @VendorId Varchar(15) = '8468AC'

BEGIN TRANSACTION

INSERT INTO [dbo].[PM00200]
           ([VENDORID]
           ,[VENDNAME]
           ,[VNDCHKNM]
           ,[VENDSHNM]
           ,[VADDCDPR]
           ,[VADCDPAD]
           ,[VADCDSFR]
           ,[VADCDTRO]
           ,[VNDCLSID]
           ,[VNDCNTCT]
           ,[ADDRESS1]
           ,[ADDRESS2]
           ,[ADDRESS3]
           ,[CITY]
           ,[STATE]
           ,[ZIPCODE]
           ,[COUNTRY]
           ,[PHNUMBR1]
           ,[PHNUMBR2]
           ,[PHONE3]
           ,[FAXNUMBR]
           ,[UPSZONE]
           ,[SHIPMTHD]
           ,[TAXSCHID]
           ,[ACNMVNDR]
           ,[TXIDNMBR]
           ,[VENDSTTS]
           ,[CURNCYID]
           ,[TXRGNNUM]
           ,[PARVENID]
           ,[TRDDISCT]
           ,[TEN99TYPE]
           ,[TEN99BOXNUMBER]
           ,[MINORDER]
           ,[PYMTRMID]
           ,[MINPYTYP]
           ,[MINPYPCT]
           ,[MINPYDLR]
           ,[MXIAFVND]
           ,[MAXINDLR]
           ,[COMMENT1]
           ,[COMMENT2]
           ,[USERDEF1]
           ,[USERDEF2]
           ,[CRLMTDLR]
           ,[PYMNTPRI]
           ,[KPCALHST]
           ,[KGLDSTHS]
           ,[KPERHIST]
           ,[KPTRXHST]
           ,[HOLD]
           ,[PTCSHACF]
           ,[CREDTLMT]
           ,[WRITEOFF]
           ,[MXWOFAMT]
           ,[SBPPSDED]
           ,[PPSTAXRT]
           ,[DXVARNUM]
           ,[CRTCOMDT]
           ,[CRTEXPDT]
           ,[RTOBUTKN]
           ,[XPDTOBLG]
           ,[PRSPAYEE]
           ,[PMAPINDX]
           ,[PMCSHIDX]
           ,[PMDAVIDX]
           ,[PMDTKIDX]
           ,[PMFINIDX]
           ,[PMMSCHIX]
           ,[PMFRTIDX]
           ,[PMTAXIDX]
           ,[PMWRTIDX]
           ,[PMPRCHIX]
           ,[PMRTNGIX]
           ,[PMTDSCIX]
           ,[ACPURIDX]
           ,[PURPVIDX]
           ,[NOTEINDX]
           ,[CHEKBKID]
           ,[MODIFDT]
           ,[CREATDDT]
           ,[RATETPID]
           ,[Revalue_Vendor]
           ,[Post_Results_To]
           ,[FREEONBOARD]
           ,[GOVCRPID]
           ,[GOVINDID]
           ,[DISGRPER]
           ,[DUEGRPER]
           ,[DOCFMTID]
           ,[TaxInvRecvd]
           ,[USERLANG]
           ,[WithholdingType]
           ,[WithholdingFormType]
           ,[WithholdingEntityType]
           ,[TaxFileNumMode]
           ,[BRTHDATE]
           ,[LaborPmtType]
           ,[CCode]
           ,[DECLID]
           ,[CBVAT]
           ,[Workflow_Approval_Status]
           ,[Workflow_Priority]
           ,[VADCD1099]
           ,[DEX_ROW_TS])
SELECT	[VendorId]
		,[VENDNAME]
		,[VNDCHKNM]
		,[VENDSHNM]
		,[VADDCDPR]
		,[VADCDPAD]
		,[VADCDSFR]
		,[VADCDTRO]
		,[VNDCLSID]
		,[VNDCNTCT]
		,[ADDRESS1]
		,[ADDRESS2]
		,[ADDRESS3]
		,[CITY]
		,[STATE]
		,[ZIPCODE]
		,[COUNTRY]
		,[PHNUMBR1]
		,[PHNUMBR2]
		,[PHONE3]
		,[FAXNUMBR]
		,[UPSZONE]
		,[SHIPMTHD]
		,[TAXSCHID]
		,[ACNMVNDR]
		,[TXIDNMBR]
		,[VENDSTTS]
		,[CURNCYID]
		,[TXRGNNUM]
		,[PARVENID]
		,[TRDDISCT]
		,[TEN99TYPE]
		,[TEN99BOXNUMBER]
		,[MINORDER]
		,[PYMTRMID]
		,[MINPYTYP]
		,[MINPYPCT]
		,[MINPYDLR]
		,[MXIAFVND]
		,[MAXINDLR]
		,[COMMENT1]
		,[COMMENT2]
		,[USERDEF1]
		,[USERDEF2]
		,[CRLMTDLR]
		,[PYMNTPRI]
		,[KPCALHST]
		,[KGLDSTHS]
		,[KPERHIST]
		,[KPTRXHST]
		,[HOLD]
		,[PTCSHACF]
		,[CREDTLMT]
		,[WRITEOFF]
		,[MXWOFAMT]
		,[SBPPSDED]
		,[PPSTAXRT]
		,[DXVARNUM]
		,[CRTCOMDT]
		,[CRTEXPDT]
		,[RTOBUTKN]
		,[XPDTOBLG]
		,[PRSPAYEE]
		,[PMAPINDX]
		,[PMCSHIDX]
		,[PMDAVIDX]
		,[PMDTKIDX]
		,[PMFINIDX]
		,[PMMSCHIX]
		,[PMFRTIDX]
		,[PMTAXIDX]
		,[PMWRTIDX]
		,[PMPRCHIX]
		,[PMRTNGIX]
		,[PMTDSCIX]
		,[ACPURIDX]
		,[PURPVIDX]
		,[NOTEINDX]
		,[CHEKBKID]
		,[MODIFDT]
		,[CREATDDT]
		,[RATETPID]
		,[Revalue_Vendor]
		,[Post_Results_To]
		,[FREEONBOARD]
		,[GOVCRPID]
		,[GOVINDID]
		,[DISGRPER]
		,[DUEGRPER]
		,[DOCFMTID]
		,[TaxInvRecvd]
		,[USERLANG]
		,[WithholdingType]
		,[WithholdingFormType]
		,[WithholdingEntityType]
		,[TaxFileNumMode]
		,[BRTHDATE]
		,[LaborPmtType]
		,[CCode]
		,[DECLID]
		,[CBVAT]
		,[Workflow_Approval_Status]
		,[Workflow_Priority]
		,[VADCD1099]
		,[DEX_ROW_TS]
FROM	PRISQL01P.GLSO.dbo.PM00200
WHERE	VENDORID = @VendorId
		AND VENDORID NOT IN (SELECT VENDORID FROM PM00200)

INSERT INTO PM00300
		([VENDORID]
		,[ADRSCODE]
		,[VNDCNTCT]
		,[ADDRESS1]
		,[ADDRESS2]
		,[ADDRESS3]
		,[CITY]
		,[STATE]
		,[ZIPCODE]
		,[COUNTRY]
		,[UPSZONE]
		,[PHNUMBR1]
		,[PHNUMBR2]
		,[PHONE3]
		,[FAXNUMBR]
		,[SHIPMTHD]
		,[TAXSCHID]
		,[EmailPOs]
		,[POEmailRecipient]
		,[EmailPOFormat]
		,[FaxPOs]
		,[POFaxNumber]
		,[FaxPOFormat]
		,[CCode]
		,[DECLID]
		,[DEX_ROW_TS])
SELECT	[VENDORID]
		,[ADRSCODE]
		,[VNDCNTCT]
		,[ADDRESS1]
		,[ADDRESS2]
		,[ADDRESS3]
		,[CITY]
		,[STATE]
		,[ZIPCODE]
		,[COUNTRY]
		,[UPSZONE]
		,[PHNUMBR1]
		,[PHNUMBR2]
		,[PHONE3]
		,[FAXNUMBR]
		,[SHIPMTHD]
		,[TAXSCHID]
		,[EmailPOs]
		,[POEmailRecipient]
		,[EmailPOFormat]
		,[FaxPOs]
		,[POFaxNumber]
		,[FaxPOFormat]
		,[CCode]
		,[DECLID]
		,[DEX_ROW_TS]
FROM	PRISQL01P.GLSO.dbo.PM00300
WHERE	VENDORID = @VendorId
		AND [VENDORID] + '_' + [ADRSCODE] NOT IN (SELECT [VENDORID] + '_' + [ADRSCODE] FROM PM00300)

IF @@ERROR > 0
	ROLLBACK TRANSACTION
ELSE
	COMMIT TRANSACTION