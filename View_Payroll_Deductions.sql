/*
SELECT 	UPR30300.PAYROLCD, 
	UPR30300.UPRTRXAM, 
	UPR30300.CHEKDATE, 
	UPR30300.PYRLRTYP, 
	UPR30300.EMPLOYID, 
	UPR30300.CHEKNMBR, 
	UPR00100.LASTNAME, 
	UPR00100.FRSTNAME, 
	UPR00100.DEPRTMNT, 
	GL00100.ACTNUMBR_1, 
	GL00100.ACTNUMBR_2, 
	GL00100.ACTNUMBR_3
FROM	IMC.dbo.UPR30300 UPR30300 
	INNER JOIN IMC.dbo.UPR00100 UPR00100 ON UPR30300.EMPLOYID=UPR00100.EMPLOYID
	INNER JOIN IMC.dbo.UPR40500 UPR40500 ON UPR30300.PAYROLCD=UPR40500.PAYROLCD
	INNER JOIN IMC.dbo.GL00100 GL00100 ON UPR40500.ACTINDX=GL00100.ACTINDX
WHERE  	UPR30300.PYRLRTYP=2 AND 
	(UPR30300.CHEKDATE>={ts '2007-05-10 00:00:00'} AND UPR30300.CHEKDATE<{ts '2007-05-10 00:00:01'})
ORDER BY UPR30300.PAYROLCD, UPR00100.DEPRTMNT
*/

CREATE VIEW View_Payroll_Deductions
AS
SELECT 	UPR30300.PAYROLCD,
	UPR30300.UPRTRXAM, 
	UPR30300.CHEKDATE, 
	UPR30300.PYRLRTYP, 
	UPR30300.EMPLOYID, 
	UPR30300.CHEKNMBR, 
	UPR00100.LASTNAME, 
	UPR00100.FRSTNAME, 
	UPR00100.DEPRTMNT,
	GL00100.ACTNUMBR_1, 
	GL00100.ACTNUMBR_2, 
	GL00100.ACTNUMBR_3
FROM 	UPR30300 
	LEFT JOIN UPR00100 ON UPR30300.EMPLOYID = UPR00100.EMPLOYID
	LEFT JOIN UPR40500 ON UPR30300.PAYROLCD = UPR40500.PAYROLCD AND UPR00100.DEPRTMNT = UPR40500.DEPRTMNT
	LEFT JOIN GL00100  ON UPR40500.ACTINDX = GL00100.ACTINDX
WHERE 	PYRLRTYP = 2

